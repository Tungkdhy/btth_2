<div>
  <div *ngIf="showMidPanel; else rightContent">
    <app-mid-panel (closeMid)="onCloseMidPanel()"></app-mid-panel>
  </div>
  <ng-template #rightContent>
    <div class="right-panel h-100">
      <div class="wrap-right-panel d-flex flex-column gap-6 h-100">
        <div class="information-warfare-wrap d-flex flex-column gap-6" style="height: 66%;">
          <div class="d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center gap-6">
              <h1 (click)="openMap(EventId.INFO_WARFARE_MAP)" [ngClass]="{ 'active-title': isInfoWarfareActive }">
                Trinh sát, tác chiến thông tin
              </h1>
              <button type="button" class="btth-btn" style="background-color: rgba(8, 8, 8, 1); color: #FFF" (click)="onShowMid(true)">
                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <mask id="mask0_379_20668" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="18"
                    height="18">
                    <rect width="18" height="18" fill="#D9D9D9" />
                  </mask>
                  <g mask="url(#mask0_379_20668)">
                    <path
                      d="M9 16.5C7.9625 16.5 6.9875 16.3031 6.075 15.9094C5.1625 15.5156 4.36875 14.9813 3.69375 14.3063C3.01875 13.6313 2.48438 12.8375 2.09063 11.925C1.69687 11.0125 1.5 10.0375 1.5 9C1.5 7.9625 1.69687 6.9875 2.09063 6.075C2.48438 5.1625 3.01875 4.36875 3.69375 3.69375C4.36875 3.01875 5.1625 2.48438 6.075 2.09063C6.9875 1.69687 7.9625 1.5 9 1.5C10.0375 1.5 11.0125 1.69687 11.925 2.09063C12.8375 2.48438 13.6313 3.01875 14.3063 3.69375C14.9813 4.36875 15.5156 5.1625 15.9094 6.075C16.3031 6.9875 16.5 7.9625 16.5 9C16.5 10.0375 16.3031 11.0125 15.9094 11.925C15.5156 12.8375 14.9813 13.6313 14.3063 14.3063C13.6313 14.9813 12.8375 15.5156 11.925 15.9094C11.0125 16.3031 10.0375 16.5 9 16.5ZM8.25 14.9625V13.5C7.8375 13.5 7.48438 13.3531 7.19063 13.0594C6.89687 12.7656 6.75 12.4125 6.75 12V11.25L3.15 7.65C3.1125 7.875 3.07812 8.1 3.04688 8.325C3.01562 8.55 3 8.775 3 9C3 10.5125 3.49687 11.8375 4.49062 12.975C5.48438 14.1125 6.7375 14.775 8.25 14.9625ZM13.425 13.05C13.9375 12.4875 14.3281 11.8594 14.5969 11.1656C14.8656 10.4719 15 9.75 15 9C15 7.775 14.6594 6.65625 13.9781 5.64375C13.2969 4.63125 12.3875 3.9 11.25 3.45V3.75C11.25 4.1625 11.1031 4.51562 10.8094 4.80937C10.5156 5.10312 10.1625 5.25 9.75 5.25H8.25V6.75C8.25 6.9625 8.17813 7.14062 8.03438 7.28438C7.89063 7.42812 7.7125 7.5 7.5 7.5H6V9H10.5C10.7125 9 10.8906 9.07188 11.0344 9.21563C11.1781 9.35938 11.25 9.5375 11.25 9.75V12H12C12.325 12 12.6188 12.0969 12.8813 12.2906C13.1438 12.4844 13.325 12.7375 13.425 13.05Z"
                      fill="white" />
                  </g>
                </svg>
                Bản đồ hình thái chung
              </button>
            </div>
            <div class="d-flex align-items-center gap-10">
              <div class="d-flex align-items-center gap-4">
                <h4>Loại mạng</h4>
                <select class="btth-select-box" (change)="changeSelectMainType($event)" [(ngModel)]="mainType">
                  <option selected value="">Tất cả</option>
                  <!-- <option *ngIf="subType=='728' || subType =='728.724'" value="QS">Quân sự</option>
                <option *ngIf="subType=='728' || subType =='728.106'" value="CD">Chuyên dùng</option> -->
                  <option value="QS">Quân sự</option>
                  <option value="CD">Chuyên dùng</option>
                  <option value="INT">Internet</option>
                </select>
              </div>
              <div class="d-flex align-items-center gap-4">
                <h4>Loại tổ chức</h4>
                <select class="btth-select-box" (change)="changeSelectSubType($event)" [(ngModel)]="subType">
                  <option selected value="728">Tất cả</option>
                  <option *ngIf="mainType==='' || mainType==='QS' || mainType==='INT'" value="728.724">Bộ Quốc phòng
                  </option>
                  <option *ngIf="mainType==='' || mainType==='CD' || mainType==='INT'" value="728.106">Hệ thống trọng yếu
                    Quốc
                    gia
                  </option>
                </select>
              </div>
              <!--        <app-avatar></app-avatar>-->
            </div>
          </div>
          <div class="d-flex flex-column gap-6">
            <div class="d-flex gap-6">
              <div class="h-100 col-3">
                <app-nuance-infor [payload]="payload" (popupToggled)="onPopupToggled($event)"
                  [isShowChiSoSacThai]="isShowChiSoSacThai"></app-nuance-infor>
              </div>
              <div class="h-100 col-9 d-flex gap-6" style="flex: 1">
                <div class="h-100 col-6">
                  <app-bieu-do-bv-tieu-cuc [payload]="payload"
                    (popupToggled)="onPopupToggled($event)"></app-bieu-do-bv-tieu-cuc>
                </div>
                <div class="h-100 col-6"  style="flex: 1">
                  <app-hot-topic [payload]="payload" (popupToggled)="onPopupToggled($event)"
                    [isShowChuDeNong]="isShowChuDeNong"></app-hot-topic>
                </div>
              </div>
            </div>
            <div class="d-flex gap-6">
              <div class="h-100 col-3 d-flex gap-6 flex-column ">
                <div style="height: 37%;" class="btth-lr-panel-card">
                  <app-information-wareface-result [payload]="payload" (popupToggled)="onPopupToggled($event)"
                    [isShowBocGo]="isShowBocGo" [isShowChiThi]="isShowChiThi"
                    [isShowTruyenThong]="isShowTruyenThong"></app-information-wareface-result>
                </div>
                <div style="height: 63%;" class="btth-lr-panel-card">
                  <app-upload-post-bar [payload]="payload" (popupToggled)="onPopupToggled($event)"
                    [isShowKQDangTai]="isShowKQDangTai"></app-upload-post-bar>
                </div>
              </div>
    
              <div class="h-100 btth-lr-panel-card col-9" style="flex: 1">
                <h2 (click)="
                      onPopupToggled({ isPopupVisible: true, typePopup: 'Overview' })
                    " [ngStyle]="{ color: isShowTongQuan ? 'green' : 'inherit' }" style="margin-bottom: 24px;">
                  Mục tiêu
                </h2>
                <div class="row">
                  <div class="col-4">
                    <app-protecting-target [payload]="payload" (popupToggled)="onPopupToggled($event)"
                      [isShowMucTieuBV]="isShowMucTieuBV"></app-protecting-target>
                  </div>
                  <div class="col-4">
                    <app-hot-spot-statistic [payload]="payload" (popupToggled)="onPopupToggled($event)"
                      [isShowDiemNong]="isShowDiemNong"></app-hot-spot-statistic>
                  </div>
                  <div class="col-4">
                    <app-monitoring-target [payload]="payload" (popupToggled)="onPopupToggled($event)"
                      [isShowMucTieuGS]="isShowMucTieuGS"></app-monitoring-target>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="d-flex flex-column gap-6 h-100">
          <h1 (click)="openMap(EventId.CYBER_WARFARE_MAP)" [ngClass]="{ 'active-title': isCyberWarfareActive }">
            Trinh sát, tác chiến mạng
          </h1>
          <div class="d-flex gap-6 h-100" style="max-width: 100%;">
            <div class="col h-100 btth-lr-panel-card">
              <app-target></app-target>
            </div>
            <div class="col h-100 btth-lr-panel-card">
              <app-exploit-level></app-exploit-level>
            </div>
            <div class="col h-100 btth-lr-panel-card">
              <app-force></app-force>
            </div>
            <div class="col h-100 btth-lr-panel-card">
              <app-collected-data></app-collected-data>
            </div>
            
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</div>

<ng-container *ngIf="payload$ | async"></ng-container>